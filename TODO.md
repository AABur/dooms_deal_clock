# TODO — Dooms Deal Clock

Ниже — только нерешённые задачи, с приоритетами. Меняем по одному направлению за раз (код или тесты).

## P1 — Критично

- Нет критичных задач — блок закрыт после корректировки `api_id` и интервала обновлений.

## P2 — Важно

- Добавить тест на `ClockService.get_updates_count`.
  - Где: `tests/unit/services/test_clock_service.py`.
  - Сценарий: вставить известное количество записей `ClockUpdate` и проверить возврат метода.
- Добавить простую аутентификацию для админки и опасных эндпоинтов (token из `.env`).
  - Где: `app/main.py` (эндпоинты `/api/clock/reset`, `/api/clock/fetch`, `/api/clock/fetch-period`, `/api/clock/reload/*`).
  - Что: заголовок `X-Admin-Token` или query `token=...`, сравнение с `ADMIN_TOKEN` из `.env`.
  - UI: добавить поле/локальное хранение токена в `web/admin.html`/`admin.js` и прокидывать его в запросы.

## P3 — Дополнительно

- Визуальное QA после синхронизации интервала (набор типовых сообщений, проверка скролла/шапки).

## Перед продом — тех‑аккаунт Telegram (важно, но последним шагом)

- Создать отдельный технический аккаунт Telegram (отдельная SIM/eSIM).
- Включить 2FA (сложный пароль, резервный e‑mail), отключить лишние активные сессии.
- Обновить `.env` (PHONE/2FA), заново пройти авторизацию в Docker (`make docker-auth`).
- Переключить прод на новый аккаунт, отозвать старые сессии.
